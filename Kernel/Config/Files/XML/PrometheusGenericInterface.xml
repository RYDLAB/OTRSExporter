<?xml version="1.0" encoding="utf-8"?>
<otrs_config version="2.0" init="Changes">

    <-- Web Service operation -->

    <Setting Name="GenericInterface::Operation::Module###Prometheus::MetricGet" Required="1" Valid="1">
        <Description Translatable="1">GenericInterface module registration for the operation layer.</Description>
        <Navigation>GenericInterface::Operation::ModuleRegistration</Navigation>
        <Value>
            <Hash>
                <Item Key="Name">MetricGet</Item>
                <Item Key="Controller">Prometheus</Item>
                <Item Key="ConfigDialog">AdminGenericInterfaceOperationDefault</Item>
            </Hash>
        </Value>
    </Setting>

    <-- Settings -->

    <Setting Name="Prometheus::Settings" Required="1" Valid="1">
        <Description Translatable="1"></Description>
        <Value>
            <Hash>
                <Item ValueType="String" Key="SharedMemoryKey">1999</Item>
                <Item ValueType="String" Key="ServerCMND">/usr/sbin/apache2 -k start</Item>
            </Hash>
        </Value>
    </Setting>

    <-- Available prometheus metric types -->

    <Setting Name="Prometheus::MetricTypes" Required="1" Valid="1">
        <Description Translatable="1">Valid metric types for prometheus</Description>
        <Value>
            <Array>
                <Item ValueType="String">counter</Item>
                <Item ValueType="String">gauge</Item>
                <Item ValueType="String">histogram</Item>
                <Item ValueType="String">summary</Item>
            </Array>
        </Value>
    </Setting>

    <-- Default metrics -->

    <Setting Name="Prometheus::Metrics::Default::Enabled" Required="0" Valid="1">
        <Description Translatable="1">Default metrics to collect</Description>
        <Value>
            <Array>
                <Item ValueType="String">HTTPRequestDurationSeconds</Item>
                <Item ValueType="String">HTTPResponseSizeBytes</Item>
                <Item ValueType="String">HTTPRequestsTotal</Item>
                <Item ValueType="String">OTRSIncomeMailTotal</Item>
                <Item ValueType="String">OTRSOutgoingMailTotal</Item>
                <Item ValueType="String">OTRSTicketTotal</Item>
                <Item ValueType="String">OTRSArticleTotal</Item>
                <Item ValueType="String">CacheOperations</Item>
                <Item ValueType="String">RecurrentTaskDuration</Item>
                <Item ValueType="String">RecurrentTaskSuccess</Item>
                <Item ValueType="String">HTTPProcessCollector</Item>
                <Item ValueType="String">DaemonProcessCollector</Item>
            </Array>
        </Value>
    </Setting>

    <-- Custom metrics creating and configuration interface -->

    <Setting Name="Prometheus::Metrics::Custom::IsEnabled" Required="0" Valid="1">
        <Description Translatable="1">Is custom metrics enabled?</Description>
        <Value>
            <Item ValueType="Checkbox">1</Item>
        </Value>
    </Setting>

    <Setting Name="Prometheus::Metrics::Custom::Configuration" Required="0" Valid="1">
        <Description Translatable="1">Custom metrics</Description>
        <Value>
            <Array>

                <DefaultItem>
                    <Hash>
                        <DefaultItem>
                            <Array><Item></Item></Array>
                        </DefaultItem>
                    </Hash>
                </DefaultItem>

                <Item>
                    <Hash>
                        <Item Key="Type"><Array><Item ValueType="String">Counter</Item></Array></Item>
                        <Item Key="Namespace"><Array><Item ValueType="String">http</Item></Array></Item>
                        <Item Key="Name"><Array><Item ValueType="String">upload_cache_total</Item></Array></Item>
                        <Item Key="Help"><Array><Item ValueType="String">Uploaded cache</Item></Array></Item>
                        <Item Key="Labels"><Array>
                            <Item>label_1</Item>
                        </Array></Item>
                        <Item Key="Buckets"><Array>
                            <Item>100</Item>
                            <Item>1000</Item>
                            <Item>10000</Item>
                        </Array></Item>
                    </Hash>
                </Item>

            </Array>
        </Value>
    </Setting>

    <-- Cron Tasks -->

    <Setting Name="Daemon::SchedulerCronTaskManager::Task###PrometheusUpdateMetrics" Required="0" Valid="1" ConfigLevel="100">
        <Description Translatable="1">Update metrics from database and /proc/</Description>
        <Navigation>Daemon::SchedulerCronTaskManager::Task</Navigation>
        <Value>
            <Hash>
                <Item Key="TaskName">PrometheusUpdateMetrics</Item>
                <Item Key="Schedule">* * * * *</Item><!-- each minute -->
                <Item Key="Module">Kernel::System::Prometheus</Item>
                <Item Key="Function">UpdateDefaultMetrics</Item>
                <Item Key="MaximumParallelInstances">1</Item>
                <Item Key="Params">
                    <Array>
                    </Array>
                </Item>
            </Hash>
        </Value>
    </Setting>

    <!--
    <Setting Name="Daemon::SchedulerCronTaskManager::Task###PrometheusUpdateCustomMetrics" Required="0" Valid="1" ConfigLevel="100">
        <Description Translatable="1">Update custom metrcis from database</Description>
        <Navigation>Daemon::SchedulerCronTaskManager::Task</Navigation>
        <Value>
            <Hash>
                <Item Key="TaskName">PrometheusUpdateCustomMetrics</Item>
                <Item Key="Schedule">*/2 * * * *</Item>
                <Item Key="Module">Kernel::System::Prometheus</Item>
                <Item Key="Function">UpdateCustomMetrics</Item>
                <Item Key="MaximumParallelInstances">1</Item>
                <Item Key="Params">
                    <Array>
                    </Array>
                </Item>
            </Hash>
        </Value>
    </Setting>
    -->

</otrs_config>
